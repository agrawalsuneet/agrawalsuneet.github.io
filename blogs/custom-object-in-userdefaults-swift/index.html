<!DOCTYPE html>
<html lang="en">

<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">

    
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WCXZ73G');
    </script>
    

    
    <script data-ad-client="ca-pub-1093303282603666" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
    </script>

    <script>
    function onErrorLoadingAds() {
      console.log("AdBlocker blocks the ads")
    }
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" 
    onerror="onErrorLoadingAds()"></script>
    

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=6">

    <meta property="og:site_name" content="Suneet Agrawal">

    <meta name="robots" content="index,follow">
    <meta name="keywords" content="userdefaults,custom object userdefaults,userdefaults swift">


    
    <meta name="author" content="Suneet Agrawal">
    <meta name="owner" content="Suneet Agrawal">
    <meta name="google-site-verification" content="ossQ8_U15s60mLv7-z4koMhDohVCMlfnvv3Ifb88mdU">

    <meta name="title" content="Suneet Agrawal | Custom Object in UserDefaults : Swift" />
    <meta property="og:title" content="Custom Object in UserDefaults : Swift">
    <meta property="twitter:title" content="Custom Object in UserDefaults : Swift">
    <meta name="twitter:site" content="@agrawalsuneet">

    <meta name="topic" content="Custom Object in UserDefaults : Swift">
    <meta name="description" content="UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults.">
    <meta property="og:description" content="UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults.">
    <meta property="twitter:description" content="UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults.">
    <meta name="abstract" content="UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults.">
    <meta name="summary" content="UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults."> 
    <meta property="og:type" content="article">
    <meta property="article:published_time" content=" 2022-03-24 "> 

    <meta name="url" content="https://agrawalsuneet.github.io/blogs/custom-object-in-userdefaults-swift/">
    <meta property="og:url" content="https://agrawalsuneet.github.io/blogs/custom-object-in-userdefaults-swift/">
    <meta property="al:web:url" content="https://agrawalsuneet.github.io/blogs/custom-object-in-userdefaults-swift/">

    <meta name="site_name" content="Suneet Agrawal">
    <meta property="og:site_name" content="Suneet Agrawal">

    <meta name="category" content="Portfolio">
    <meta name="email" content="agrawalsuneet@gmail.com">
    <meta name="og:email" content="agrawalsuneet@gmail.com">

    <meta name="twitter:creator" content="@agrawalsuneet">
    <link rel="canonical" href="https://agrawalsuneet.github.io/blogs/custom-object-in-userdefaults-swift/">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="target" content="all" />
    <meta name="audience" content="all" />
    <meta name="coverage" content="Worldwide" />
    <meta name="distribution" content="Global">
    <meta name="rating" content="safe for kids" /> 
    <meta property="og:tags" content="Swift"> 
    <meta property="og:tags" content="iOS"> 
    <title>Custom Object in UserDefaults : Swift &middot; Suneet Agrawal</title>

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 

    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/style.css">
    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/custom.css">
    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/layout.css"> 
    <link href="https://agrawalsuneet.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Suneet Agrawal" />  
    <link rel="icon" href="https://agrawalsuneet.github.io/suneet_icon.ico" /> 
</head>

<body>

    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WCXZ73G" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
    

    
    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
     <nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="https://agrawalsuneet.github.io/">Suneet Agrawal</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
					<li><a href="https://agrawalsuneet.github.io/publications">Publications</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/publicappearances">Public Appearances</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/personalgamesandapps">Personal Games &amp; Apps</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/opensourcecontribution">Open Source Contribution</a></li>
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		<div id="menu" class="hidden-xs col-sm-4 col-md-3">
	<div id="menu-content" class="vertical-align">

		
			<a href="https://agrawalsuneet.github.io/">
				<img id="profile-pic" src="https://agrawalsuneet.github.io//img/suneet.jpg" alt="My Picture" class="img-circle center-block">
			</a>
		

		
			<h1 class="text-center" style="font-size:30px;">
				<a href="https://agrawalsuneet.github.io/">
					Suneet Agrawal
				</a>
		</h1>
		

		

		<div id="links" class="text-center" style="margin-top:50px; margin-bottom:50px; font-size:24px; color:#ffffff">
			
			
				<a href="https://agrawalsuneet.github.io/publications">
						Publications
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/publicappearances">
						Public Appearances
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/personalgamesandapps">
						Personal Games &amp; Apps
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/opensourcecontribution">
						Open Source Contribution
				</a>
				</br>
			
		</div>

		<div id="social" class="text-center">
			
				<a href="https://github.com/agrawalsuneet"><i class="fa fa-github fa-2x"></i></a>
			
				<a href="https://www.linkedin.com/in/agrawalsuneet/"><i class="fa fa-linkedin fa-2x"></i></a>
			
				<a href="https://medium.com/@agrawalsuneet"><i class="fa fa-medium fa-2x"></i></a>
			
				<a href="https://www.instagram.com/agrawalsuneet/"><i class="fa fa-instagram fa-2x"></i></a>
			
				<a href="https://www.facebook.com/agrawalsuneet"><i class="fa fa-facebook fa-2x"></i></a>
			

			<a href="mailto:agrawalsuneet@gmail.com"><i class="fa fa-envelope-o fa-2x"></i></a>
		</div>



	</div>
</div>

		<div id="content" class="col-xs-12 col-sm-8 col-md-9">
			<div class="row">
				<div id="post" class="col-xs-12">
 
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112616552-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<main>
    <header>
        <h1 class="mx16">Custom Object in UserDefaults : Swift</h1>
    </header>

    <div class="col-xs-12 vertical-centre">
        
        <small class="text-muted">
			
			
				<a href="https://agrawalsuneet.github.io/tags/swift"><span class="label label-success">Swift</span></a>
			
				<a href="https://agrawalsuneet.github.io/tags/ios"><span class="label label-success">iOS</span></a>
			
		</small> 

        

    </div>

    <article>
        <div class="col-xs-12">
            </br>
<div class="row">
<div class="col-lg-10">
<div class="center-justified text-content">
        In continuation to my previous blog <a href="/blogs/userdefaults-in-swift/" target="_blank">UserDefaults in Swift</a>, where we understand the basic functionality of UserDefaults, we'll try to understand today how can we store custom objects in UserDefaults. 
        <br>
        </br>
        UserDefaults provides us with direct functions for storing primitive data types like Int, Double, Bool, and String. But for custom data types, there is no direct way to store them in UserDefaults. But there is a workaround with which we can store the custom object to UserDefaults. Let's try to understand in detail along with an example.
</div>
<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<h3>
What are Custom Objects and Codable?
</h3>
<div class="center-justified text-content">
    User-defined class or struct objects are known as custom objects. These classes or structs can have any number of properties. 
    </br>
    </br>
    To store them in UserDefaults, we need to implement or confirm <mark>Codable</mark> to the user-defined class or struct.
    </br>
    </br>
    <mark>Codable</mark> is a typealias of <mark>Decodable</mark> & <mark>Encodable</mark> protocols. It adds the functionality of Encoding and Decoding to the class or struct.
</div>
<pre class="zeropadding">
  <br/>/// A type that can convert itself into and out of an external representation.<br/>///<br/>/// `Codable` is a type alias for the `Encodable` and `Decodable` protocols.<br/>/// When you use `Codable` as a type or a generic constraint, it matches<br/>/// any type that conforms to both protocols.<br/>public typealias <b>Codable</b> = <b>Decodable</b> & <b>Encodable</b><br/>
</pre>

<div class="center-justified text-content">
   To implement or confirm the <mark>Codable</mark> protocol, we can add the protocol and go with coding keys as the variable names or can define our own custom keys according to the need.
</div>
<pre class="zeropadding">
  <br/>//MARK :- Employee<br/>struct <b>Employee</b>: <b>Codable</b> {<br/>    let employeeId: Int<br/>    let name, department: String<br/>}<br/><br/>// OR<br/><br/>//MARK :- Employee<br/>struct <b>Employee</b>: <b>Codable</b> {<br/>    let employeeID: Int<br/>    let name, department: String<br/><br/>    enum CodingKeys: String, CodingKey {<br/>        case employeeID = "employeeId"<br/>        case name, department<br/>    }<br/>}<br/>
</pre>

<div class="center-justified text-content">
   Keep in mind that any custom class used inside the <mark>Codable</mark> class or struct should also confirm the <mark>Codable</mark> protocol.
</div>
<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<h3>
How to store custom object in UserDefaults?
</h3>
<div class="center-justified text-content">
    <mark>Codable</mark> provides the functionality to convert an object into a <mark>Data</mark> class object.
    </br>
    </br>
    UserDefaults has a function similar to primitive data types which takes an <mark>Any?</mark> class object and store the value against the key provided. 
</div>
<pre class="zeropadding">
  <br/>/**<br/>-setObject:forKey: immediately stores a value (or removes the value if nil is passed as the value) for the provided key in the search list entry for the receiver's suite name in the current user and any host, then asynchronously stores the value persistently, where it is made available to other processes.<br/>*/<br/>open func <b>set</b>(_ value: Any?, forKey defaultName: String)<br/>
</pre>

<div class="center-justified text-content">
    We can't provide the object directly but we need to convert the object into a <mark>Data</mark> class object using <mark>JSONEncoder</mark>, else it will throw the below error.
</div>
<pre class="zeropadding">
  <br/><e>Attempt to insert non-property list object &lt;object name&gt; for key &lt;key&gt;</e><br/>
</pre>

<div class="center-justified text-content">
    Also, since <mark>JSONEncoder</mark> can throw an error if the object is not encoded properly, we need to wrap it around the <mark>try-catch</mark> block. 
    </br>
    </br>
    Once the codable is converted to the <mark>Data</mark> class object, we can put it into UserDefaults using the above <mark>set</mark> method. 
    </br>
    The final code will look like the below.
</div>
<pre class="zeropadding">
  <br/>let employee = Employee(employeeId: 100, <br/>                        name: "Suneet Agrawal", <br/>                        department: "Engineering")<br/><br/>do {<br/>    let data = try <b>JSONEncoder()</b>.encode(employee)<br/>    UserDefaults.standard.<b>set</b>(data, forKey: "employee")<br/>} catch let error {<br/>    print("Error encoding: \(error)")<br/>}<br/>
</pre>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<h3>
How to retrieve custom object from UserDefaults?
</h3>
<div class="center-justified text-content">
    UserDefaults has a function to retrieve <mark>Data</mark> class objects similar to any other primitive data type.
    </br>
    The same can be used to retrieve data from UserDefaults but the returned result will be in the <mark>Data?</mark> class object. 
</div>
<pre class="zeropadding">
  <br/>/// -dataForKey: is equivalent to -objectForKey:, except that it will return nil if the value is not an NSData.<br/>open func data(forKey defaultName: String) -> Data?<br/>
</pre>

<div class="center-justified text-content">
    Keep in mind that it can also return <mark>nil</mark> if no such data is stored with the key. In that case, we need to add a null safety also.
</div>
<pre class="zeropadding">
  <br/>if let data = UserDefaults.standard.<b>data(</b>forKey: "employee") {<br/>    //do something here<br/>}<br/>
</pre>

</br>
<div class="center-justified text-content">
    Now that we got the data back, we can convert it into the same original class or struct object (<mark>Employee</mark> in our case) using <mark>JSONDecoder</mark>.
    </br>
    </br>
    But similar to <mark>JSONEncoder</mark>, <mark>JSONDecoder</mark> can also throw an error if the object is not decoded properly, we need to wrap it around the <mark>try-catch</mark> block. 
</div>
<pre class="zeropadding">
  <br/>do {<br/>    if let data = UserDefaults.standard.<b>data</b>(forKey: "employee") {<br/>        let employee = try <b>JSONDecoder</b>().decode(Employee.self, from: data)<br/>        print(employee)<br/>    }<br/>} catch let error {<br/>    print("Error decoding: \(error)")<br/>}<br/>
</pre>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<h3>
Generic Extension
</h3>
<div class="center-justified text-content">
    We can even add a generic functionality to the UserDefaults class which will store the <mark>Codable</mark> class or struct object of Template type and retrieve back the same object using the same key.
</div>
</br>
<script type="application/javascript" src="https://gist.github.com/agrawalsuneet/2546e6c36c01d8ac4808fce3a781e819.js"></script>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
<div class="center-justified text-content">
    The above functions can be used as below.
</div>
<pre class="zeropadding">
  <br/>let employee = Employee(employeeId: 100, <br/>                        name: "Suneet", <br/>                        department: "Engineering") <br/><br/>//setting the object<br/>UserDefaults.standard.<b>storeCodable</b>(employee, key: "employee")<br/><br/>//getting the object<br/>let emp : Employee? = UserDefaults.standard.<b>retrieveCodable</b>(for: "employee")<br/><br/>print(emp) <br/>//this will print optional<br/><br/>if let emp = emp {<br/>    print(emp)<br/>}<br/>
</pre>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
</div>
<div class="col-lg-2 position-sticky-top">
<div class="googleads">
    
    <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-1093303282603666"
        data-ad-slot="5801291010"
        data-ad-format="vertical"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
</div>
</div>
<div class="col-xs-12 center-justified text-subtitle">
    <div class="col-sm-6 col-xs-12">
        <a href="/blogs/">
        &lt;&lt; All Blogs
      </a>
    </div>
    <div class="col-sm-6 col-xs-12 text-right">
        <a href="/blogs/double-vs-float-swift/">
        Double vs Float : Swift &gt;&gt;
      </a>
    </div>
</div>

        </div>
    </article>
</main>

<script
    data-name="BMC-Widget" 
    data-cfasync="false" 
    src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" 
    data-id="agrawalsuneet" 
    data-description="Support me on Buy me a coffee!" 
    data-message="If you find this blog helpful, support us to keep this website up and free !!!" 
    data-color="#ff813f" 
    data-position="Right" 
    data-x_margin="18" 
    data-y_margin="18"></script>

 
<div id="disqus_thread">
    <div id="disqus_empty"></div>
</div>

<script type="text/javascript" defer>

    function onContentScrolled(e) {
        var currentScroll = document.scrollingElement.scrollTop;
        var disqus_target = document.getElementById('disqus_thread');

        if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
            load_disqus();
            console.log('Disqus comments loaded');
        }
    }

    function load_disqus() {
        if (window.location.hostname == "localhost") {
            var content = document.getElementById("content");
            content.removeEventListener('scroll', onContentScrolled, false)
            return;
        }

        
        var is_disqus_empty = document.getElementById('disqus_empty'),
            disqus_target = document.getElementById('disqus_thread'),
            disqus_embed = document.createElement('script'),
            disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

        var disqus_shortname = 'agrawalsuneet';

        
        if (disqus_target && is_disqus_empty) {
            disqus_embed.type = 'text/javascript';
            disqus_embed.async = true;
            disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            disqus_hook.appendChild(disqus_embed);
            is_disqus_empty.remove();
        }

        var content = document.getElementById("content");
        content.removeEventListener('scroll', onContentScrolled, false)

        
        let remove_ads = setInterval(() => {
            console.log('Checking for Disqus Ads');

            let iframes = document.getElementsByTagName('iframe');

            for (var iframe in iframes) {
                
                
                

                
                
                
                
                

                if (iframes[iframe].id.includes("dsq") 
                && iframes[iframe].name.includes("dsq") 
                && !iframes[iframe].src.includes("disqus.com/embed/comments")) {
                    iframes[iframe].style.display = 'none';
                    clearInterval(remove_ads);
                    console.log('Disqus Ads removed');
                }
            }
        }, 1000);

        setTimeout(function () {
            clearInterval(remove_ads);
        }, 5000);
    }

    (function () {
        var content = document.getElementById("content");
        content.addEventListener('scroll', onContentScrolled, false);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>


						</div>
					</div>
				</div>
			</div>
		</div>
  </div>


  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'code-here', 'auto');
    ga('send', 'pageview');
    window.baseURL = "https:\/\/agrawalsuneet.github.io\/";
  </script>
  


  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  
  
  <script src="https://agrawalsuneet.github.io//js/App.js"></script>
  
</body>
</html>