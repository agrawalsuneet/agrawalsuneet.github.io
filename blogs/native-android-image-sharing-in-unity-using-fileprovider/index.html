<!DOCTYPE html>
<html lang="en">

<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">

    
    <script>
        (function(w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s),
                dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src =
                'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WCXZ73G');
    </script>
    

    
    <script data-ad-client="ca-pub-1093303282603666" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=6">

    <meta property="og:site_name" content="Suneet Agrawal">

    <meta name="robots" content="index,follow">
    <meta name="keywords" content="FileUriExposedException,native android image sharing in unity, unity android, android unity, android fileprovider">


    
    <meta name="author" content="Suneet Agrawal">
    <meta name="owner" content="Suneet Agrawal">
    <meta name="google-site-verification" content="ossQ8_U15s60mLv7-z4koMhDohVCMlfnvv3Ifb88mdU">

    <meta name="title" content="Suneet Agrawal | Native Android image sharing in Unity using FileProvider" />
    <meta property="og:title" content="Native Android image sharing in Unity using FileProvider">
    <meta property="twitter:title" content="Native Android image sharing in Unity using FileProvider">
    <meta name="twitter:site" content="@agrawalsuneet">

    <meta name="topic" content="Native Android image sharing in Unity using FileProvider">
    <meta name="description" content="Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app.">
    <meta property="og:description" content="Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app.">
    <meta property="twitter:description" content="Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app.">
    <meta name="abstract" content="Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app.">
    <meta name="summary" content="Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app."> 
    <meta property="og:type" content="article">
    <meta property="article:published_time" content=" 2020-10-26 "> 

    <meta name="url" content="https://agrawalsuneet.github.io/blogs/native-android-image-sharing-in-unity-using-fileprovider/">
    <meta property="og:url" content="https://agrawalsuneet.github.io/blogs/native-android-image-sharing-in-unity-using-fileprovider/">
    <meta property="al:web:url" content="https://agrawalsuneet.github.io/blogs/native-android-image-sharing-in-unity-using-fileprovider/">

    <meta name="site_name" content="Suneet Agrawal">
    <meta property="og:site_name" content="Suneet Agrawal">

    <meta name="category" content="Portfolio">
    <meta name="email" content="agrawalsuneet@gmail.com">
    <meta name="og:email" content="agrawalsuneet@gmail.com">

    <meta name="twitter:creator" content="@agrawalsuneet">
    <link rel="canonical" href="https://agrawalsuneet.github.io/blogs/native-android-image-sharing-in-unity-using-fileprovider/">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="target" content="all" />
    <meta name="audience" content="all" />
    <meta name="coverage" content="Worldwide" />
    <meta name="distribution" content="Global">
    <meta name="rating" content="safe for kids" /> 
    <meta property="og:tags" content="CSharp"> 
    <meta property="og:tags" content="Unity"> 
    <meta property="og:tags" content="Android">  <meta name="generator" content="Hugo 0.59.0" />
    <title>Native Android image sharing in Unity using FileProvider &middot; Suneet Agrawal</title>

    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 

    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/style.css">
    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/custom.css">
    <link rel="stylesheet" href="https://agrawalsuneet.github.io/css/layout.css"> 
    <link href="https://agrawalsuneet.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Suneet Agrawal" />  
    <link rel="icon" href="https://agrawalsuneet.github.io/suneet_icon.ico" /> 
</head>

<body>

    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WCXZ73G" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
    

    
    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
     <nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="https://agrawalsuneet.github.io/">Suneet Agrawal</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
					<li><a href="https://agrawalsuneet.github.io/publications">Publications</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/publicappearances">Public Appearances</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/personalgamesandapps">Personal Games &amp; Apps</a></li>
				
					<li><a href="https://agrawalsuneet.github.io/opensourcecontribution">Open Source Contribution</a></li>
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		<div id="menu" class="hidden-xs col-sm-4 col-md-3">
	<div id="menu-content" class="vertical-align">

		
			<a href="https://agrawalsuneet.github.io/">
				<img id="profile-pic" src="https://agrawalsuneet.github.io//img/suneet.jpg" alt="My Picture" class="img-circle center-block">
			</a>
		

		
			<h1 class="text-center" style="font-size:30px;">
				<a href="https://agrawalsuneet.github.io/">
					Suneet Agrawal
				</a>
		</h1>
		

		

		<div id="links" class="text-center" style="margin-top:50px; margin-bottom:50px; font-size:24px; color:#ffffff">
			
			
				<a href="https://agrawalsuneet.github.io/publications">
						Publications
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/publicappearances">
						Public Appearances
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/personalgamesandapps">
						Personal Games &amp; Apps
				</a>
				</br>
			
				<a href="https://agrawalsuneet.github.io/opensourcecontribution">
						Open Source Contribution
				</a>
				</br>
			
		</div>

		<div id="social" class="text-center">
			
				<a href="https://github.com/agrawalsuneet"><i class="fa fa-github fa-2x"></i></a>
			
				<a href="https://www.linkedin.com/in/agrawalsuneet/"><i class="fa fa-linkedin fa-2x"></i></a>
			
				<a href="https://medium.com/@agrawalsuneet"><i class="fa fa-medium fa-2x"></i></a>
			
				<a href="https://www.instagram.com/agrawalsuneet/"><i class="fa fa-instagram fa-2x"></i></a>
			
				<a href="https://www.facebook.com/agrawalsuneet"><i class="fa fa-facebook fa-2x"></i></a>
			

			<a href="mailto:agrawalsuneet@gmail.com"><i class="fa fa-envelope-o fa-2x"></i></a>
		</div>



	</div>
</div>

		<div id="content" class="col-xs-12 col-sm-8 col-md-9">
			<div class="row">
				<div id="post" class="col-xs-12">
 
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-112616552-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<main>
    <header>
        <h1 class="mx16">Native Android image sharing in Unity using FileProvider</h1>
    </header>

    <div class="col-xs-12 vertical-centre">
        
        <small class="text-muted">
			
			
				<a href="https://agrawalsuneet.github.io/tags/csharp"><span class="label label-success">CSharp</span></a>
			
				<a href="https://agrawalsuneet.github.io/tags/unity"><span class="label label-success">Unity</span></a>
			
				<a href="https://agrawalsuneet.github.io/tags/android"><span class="label label-success">Android</span></a>
			
		</small> 

        

    </div>

    <article>
        <div class="col-xs-12">
            <p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-unity.png" alt="Native Android in Unity"></p>

<p></br></p>

<div class="center-justified text-content">
        While implementing native sharing using my previous post, <a href="/blogs/native-android-image-sharing-in-unity/" target="_blank">Native Android image sharing in Unity</a> we saw an exception “android.os.FileUriExposedException” in Android 8 (Oreo) and above.
        </br>
        </br>
        Since Google changed the sharing way using FileProvider to make it more secure, we can not share the file object directly to any other Application. We need to use the FileProvider and grant read URI permission to make it accessible for any other app.
</div>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<div class="center-justified text-content">
        In this blog, will guide step by step to enable image sharing to any other app using FileProvider. After this, you can share your screenshots or image to any other apps on above Android 8 (Oreo) also. Please stay with me as it's going to be a long journey.
        </br>
        </br>
        But before that, I would suggest to please go through my last blogs that will give an insight into what we are trying to achieve.
        </br>
        </br>
        If you have not read the previous medium posts, I would strongly recommend to read them first. You can read them on the links below.
        <ul>
                <li><a href="/blogs/native-android-in-unity/" target="_blank">Native Android in Unity</a></li>
                <li><a href="/blogs/native-android-text-sharing-in-unity/" target="_blank">Native Android text sharing in Unity</a></li>
                <li><a href="/blogs/native-android-image-sharing-in-unity/" target="_blank">Native Android image sharing in Unity</a></li>
        </ul>
        </br>
        </br>
        To use file provider in Unity and share a screenshot/image, we need to follow below steps.
        </br>
        </br>
        <ol>
                <li>Create a project and separate module in Native Android using Android Studio.</li>
                <li>Define paths in xml file in native android.</li>
                <li>Define Provider in Android manifest file.</li>
                <li>Export it as an Android archive file (.aar) from Android Studio.</li>
                <li>Enable Gradle dependency in Unity project.</li>
                <li>Add Support dependency in the gradle file.</li>
                <li>Change sharing intent code in the C# file.</li>
        </ol>
        </br>
        We can skip the first 4 steps and can use “.aar” file generated by me (which I will share) also but to give everyone an insight about what is happening exactly,
        </br>
        </br>
        Let’s go step by step.
</div>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
1. Create a project and separate module in Native Android using Android Studio
</h3>

<div class="center-justified text-content">
        Since putting a raw Android XML is not allowed in Unity, we need a separate Android module containing our code and export it as an aar file to use it in Unity. To create the same we need Android studio. I am not going to follow on how to download and setup android studio. You can Google it and set it up.
        </br>
        </br>
        Create a new project in Android studio.
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-1.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content">
        Select the minimum API level same as your unity project and fill all remaining fields. These fields really don’t matter as we are going to create a separate library in this project. Click on finish.
        </br>
        </br>
        Create new “Android Library Module” in the same project by clicking File > New > New Module.
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-2.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content">
        Name the library and click finish.
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-3.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content">
        Once this is done, we can remove the unnecessary dependencies and folders like “test” and “androidTest” folder. We can also remove the string.xml file. We can even remove the testing dependency from build.gradle of our library.
</div>

<pre class="zeropadding">
  <br/>//testInstrumentationRunner <br/>//     "android.support.test.runner.AndroidJUnitRunner"<br/>and<br/>//testImplementation 'junit:junit:4.12'<br/>//androidTestImplementation 'com.android.support.test:runner:1.0.2'<br/>//androidTestImplementation <br/>//          'com.android.support.test.espresso:espresso-core:3.0.2'<br/>
</pre>


<div class="center-justified text-content">
        Please note that we need appcompat support library. The final build.gradle will be
</div>

<pre class="zeropadding">
  <br/>apply plugin: 'com.android.library'<br/><br/>android {<br/>    compileSdkVersion 28<br/><br/>    defaultConfig {<br/>        minSdkVersion 14<br/>        targetSdkVersion 28<br/>        versionCode 1<br/>        versionName "1.0"<br/><br/>        testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"<br/><br/>    }<br/><br/>    buildTypes {<br/>        release {<br/>            minifyEnabled false<br/>            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'<br/>        }<br/>    }<br/>}<br/><br/>dependencies {<br/>    implementation fileTree(dir: 'libs', include: ['*.jar'])<br/>    implementation 'com.android.support:appcompat-v7:28.0.0'<br/>}<br/>
</pre>


<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
2. Define paths in xml file in native android
</h3>

<div class="center-justified text-content">
        Create a new XML resource file with name provider_paths.xml in our library.
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-4.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content">   
        replace the below code in the created provider_paths.xml file and save it.
</div>

<pre class="zeropadding">
  <br/> &lt;?xml version="1.0" encoding="utf-8"? &gt;<br/> &lt;paths xmlns:android="http://schemas.android.com/apk/res/android" &gt;<br/>     &lt;external-path name="external_files" path="."/ &gt;<br/> &lt;/paths &gt;<br/>
</pre>


<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
3. Define Provider in Android manifest file.
</h3>

<div class="center-justified text-content"> 
        Define Provider in the manifest.xml file of the library.  
</div>

<pre class="zeropadding">
  <br/> &lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>    package="com.agrawalsuneet.unitysharing" &gt;<br/>     &lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" / &gt;<br/>     &lt;application &gt;<br/>         &lt;provider<br/>            android:name="android.support.v4.content.FileProvider"<br/>            android:authorities="${applicationId}.provider"<br/>            android:exported="false"<br/>            android:grantUriPermissions="true" &gt;<br/>             &lt;meta-data<br/>                android:name="android.support.FILE_PROVIDER_PATHS"<br/>                android:resource="@xml/provider_paths" / &gt;<br/>         &lt;/provider &gt;<br/>     &lt;/application &gt;   <br/> &lt;/manifest &gt;<br/>
</pre>


<div class="center-justified text-content">  
        Please note that we are adding write external storage permission here only but you can add it in unity also. I added here so that we don’t miss it. 
</div>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
4. Export it as an Android archive file (.aar) from Android Studio
</h3>

<div class="center-justified text-content"> 
        To export the aar file out of our library, run the below command in the terminal on our root folder of android project.  
</div>

<pre class="zeropadding">
  <br/>./gradlew assembleRelease<br/>
</pre>


<div class="center-justified text-content">
        This will generate a release android archive (.aar) file in unitysharing/build/outputs/aar/ folder.   
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-5.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
5. Enable Gradle dependency in Unity project
</h3>

<div class="center-justified text-content">   
        I am assuming here that everyone who is here already has a unity project and knows at least basics of unity and the folder structures in unity.
        </br>
        </br>
        Copy the aar file generate from Android studio and place it in /Assets/Plugins/Android/ folder.
        </br>
        </br>
        Create Plugins and Android folder if not there and inside the Android folder put the aar file.
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-6.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content">  
        Please note that I have changed the name of the aar file from “unitysharing-release.aar” to “unitysharing.aar” but it really doesn’t matter. The name of the file really does not make any difference.
        </br>
        </br>
        Now if you remember, we added a dependency of appcompat support library in our android library’s build.gradle file. Since the FileProvider is defined in that support library of Android only, we need the same in our unity project also. To add that dependency in our unity project we need to enable the custom build.gradle file for our unity project.
        </br>
        </br>
        Open File > Build Settings in Unity.
        </br>
        </br>
        Switch platform to Android.
        </br>
        </br>
        Open Player Settings and navigate to the Publishing Settings section.
        </br>
        </br>
        Check the checkbox next to “Custom Gradle Template”. This will generate a “mainTemplate.gradle” file in the same Assets/Plugins/Android folder. 
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-7.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
6. Add Support dependency in the gradle file.
</h3>

<div class="center-justified text-content">   
        Open the newly created “mainTemplate.gradle” file in any editor.
        </br>
        </br>
        Add the below line at the bottom of that file.
</div>

<pre class="zeropadding">
  <br/>dependencies {<br/>    implementation fileTree(include: ['*.jar'], dir: 'libs')<br/>    implementation 'com.android.support:appcompat-v7:28.0.0'<br/>}<br/>
</pre>


<div class="center-justified text-content">   
        Please note if you already using the custom gradle file, add only appcompat dependency into your <mark>dependencies</mark> section. Please do not touch the <mark>dependencies</mark> block above <mark>android</mark> block. That dependency block is for root project similar to native android.
        </br>
        </br>
        Please be careful with this file otherwise the project will not compile. Also, do not touch anything which is auto-generated. My final mainTemplate.gradle file will look like below.
</div>

<p></br></p>

<script type="application/javascript" src="https://gist.github.com/agrawalsuneet/ef340aa65bcbd511882e99226e100cbb.js"></script>


<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<h3>
7. Change sharing intent code in the C# file
</h3>

<div class="center-justified text-content"> 
        This is the final change. I am assuming that whoever is here had already read my previous post <a href="/blogs/native-android-image-sharing-in-unity/" target="_blank">Native Android image sharing in Unity</a> and is aware of the basic intent object we created to share.
        </br>
        </br>
        Since last time we were creating the URI object by parsing the File object which is not allowed now, we will create the URI object using FileProvider.  
</div>

<pre class="zeropadding">
  <br/><l>//old code which is not allowed in Android 8 or above</l><br/>//create image URI to add it to the intent<br/>//AndroidJavaClass uriClass = new AndroidJavaClass ("android.net.Uri");<br/>//AndroidJavaObject uriObject = <br/>//uriClass.CallStatic &lt;AndroidJavaObject &gt;("parse", "file://" <br/>// + screenShotPath);<br/><br/>//create file object of the screenshot captured<br/>AndroidJavaObject fileObject = new AndroidJavaObject("java.io.File", screenShotPath);<br/><br/>//create FileProvider class object<br/>AndroidJavaClass fileProviderClass = new AndroidJavaClass("android.support.v4.content.FileProvider");<br/>object[] providerParams = new object[3];<br/>providerParams[0] = currentActivity;<br/>providerParams[1] = "com.agrawalsuneet.unityclient.provider";<br/>providerParams[2] = fileObject;<br/><br/>//instead of parsing the uri, <br/>//will get the uri from file using FileProvider<br/>AndroidJavaObject uriObject = fileProviderClass.CallStatic &lt;AndroidJavaObject &gt;("getUriForFile", providerParams);<br/>
</pre>


<div class="center-justified text-content">   
        Please note that the object passed at position 1 in the array should be your &lt;application id&gt;.provider
        </br>
        </br>
        This is the same as what we defined in the manifest file of the Android library.
</div>

<pre class="zeropadding">
  <br/>android:authorities="${applicationId}.provider"<br/>
</pre>


<div class="center-justified text-content">  
        Crosscheck the spelling correctly.
        </br>
        </br>
        Additionally, add the granting permission to read the URI as a flag to the intent. 
</div>

<pre class="zeropadding">
  <br/>//additionally grant permission to read the uri<br/>intentObject.Call &lt;AndroidJavaObject &gt;("addFlags", intentClass.GetStatic &lt;int &gt;("FLAG_GRANT_READ_URI_PERMISSION") );<br/>
</pre>


<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<div class="center-justified text-content">   
        The final script will look like below.
</div>

<p></br></p>

<script type="application/javascript" src="https://gist.github.com/agrawalsuneet/378ce344c92a32e8f6289d6fd5a28ca4.js"></script>


<div class="center-justified text-content"> 
        Connect this script to any game object and assign the Button and we are done.  
</div>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-8.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<p><img class="blogimg" src="/img/blogs/native-android-image-sharing-in-unity-using-fileprovider/native-android-image-sharing-in-unity-using-fileprovider-9.png" alt="Native Android image sharing in Unity using FileProvider"></p>

<p></br></p>

<div class="center-justified text-content"> 
        I have uploaded all the code (Android and Unity both) into a public Github repository <a href="https://github.com/agrawalsuneet/UnitySharingCenter" target="_blank">UnitySharingCenter</a>.
        </br>
        </br>
        I have also kept my “aar” public which can be directly used in any Unity project and can skip the above 4 steps. Please find the aar at <a href="https://github.com/agrawalsuneet/UnitySharingCenter/releases/tag/v1" target="_blank">UnitySharingCenter/Releases</a>
        </br>
        </br>
        Thank you for your patience. Please write in comments sections if it worked fine for you or not.
</div>

<div class="col-xs-12 googleads">
    
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1093303282603666"
     data-ad-slot="5254968909"
     data-ad-format="horizontal"
     data-full-width-responsive="true"></ins>
     
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

<div class="col-xs-12 center-justified text-subtitle">
    <div class="col-sm-6 col-xs-12">
        <a href="/blogs">
        &lt;&lt; All Blogs
      </a>
    </div>
    <div class="col-sm-6 col-xs-12 text-right">
        <a href="/blogs/native-android-in-unity/">
        Native Android in Unity &gt;&gt;
      </a>
    </div>
</div>

        </div>
    </article>
</main>

 
<div id="disqus_thread">
    <div id="disqus_empty"></div>
</div>

<script type="text/javascript" defer>

    function onContentScrolled(e) {
        var currentScroll = document.scrollingElement.scrollTop;
        var disqus_target = document.getElementById('disqus_thread');

        if (disqus_target && (currentScroll > disqus_target.getBoundingClientRect().top - 150)) {
            load_disqus();
            console.log('Disqus comments loaded');
        }
    }

    function load_disqus() {
        if (window.location.hostname == "localhost") {
            var content = document.getElementById("content");
            content.removeEventListener('scroll', onContentScrolled, false)
            return;
        }

        
        var is_disqus_empty = document.getElementById('disqus_empty'),
            disqus_target = document.getElementById('disqus_thread'),
            disqus_embed = document.createElement('script'),
            disqus_hook = (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]);

        var disqus_shortname = 'agrawalsuneet';

        
        if (disqus_target && is_disqus_empty) {
            disqus_embed.type = 'text/javascript';
            disqus_embed.async = true;
            disqus_embed.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            disqus_hook.appendChild(disqus_embed);
            is_disqus_empty.remove();
        }

        var content = document.getElementById("content");
        content.removeEventListener('scroll', onContentScrolled, false)
    }

    (function () {
        var content = document.getElementById("content");
        content.addEventListener('scroll', onContentScrolled, false);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>


						</div>
					</div>
				</div>
			</div>
		</div>
  </div>


  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'code-here', 'auto');
    ga('send', 'pageview');
    window.baseURL = "https:\/\/agrawalsuneet.github.io\/";
  </script>
  


  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  
  
  <script src="https://agrawalsuneet.github.io//js/App.js"></script>
  
</body>
</html>